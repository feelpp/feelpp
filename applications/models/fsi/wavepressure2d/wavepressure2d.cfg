[fsi]
fixpoint.tol=1e-6#1e-8
fixpoint.initialtheta=0.05
conforming-interface=true
coupling-type=Semi-Implicit #Semi-Implicit
solid-mesh.extract-1d-from-fluid-mesh=1

[fluid]
filename=$top_srcdir/applications/models/fsi/wavepressure2d/wavepressure2d_fluid.json

hsize=0.1#0.05#0.075#0.05
geofile=$top_srcdir/applications/models/fsi/wavepressure2d/wavepressure2d_fluid.geo

# physical model and parameters
mu=0.035
rho=1
model=Oseen#Navier-Stokes#Oseen #Navier-Stokes, Oseen
stabilisation-convection-energy=true
stabilisation-cip-convection=true
marked-zones.expressions=(x<0.3)+(x>(6-0.3)):x


fluid-outlet.type=windkessel#free
fluid-outlet.number=1
fluid-outlet.windkessel.coupling=implicit
fluid-outlet.windkessel.Rd0=6.2e3
fluid-outlet.windkessel.Rp0=400
fluid-outlet.windkessel.Cd0=2.72e-4

#hovisu=true
#use-cst-matrix=false
#use-cst-vector=false

reuse-prec=true
#reuse-jac=true
reuse-jac.rebuild-at-first-newton-step=false
#residual-uselinearjac=true
#ksp-converged-reason=true
#snes-converged-reason=true


###################################
pc-type=lu #gasm#lu #asm#fieldsplit #ilu
ksp-maxit=30

[fluid.alemesh]
type=harmonic
pc-type=lu
ksp-maxit=30
reuse-prec=true
[fluid.alemesh.ho]
pc-type=lu
ksp-maxit=30
reuse-prec=true
[fluid.bdf]
order=2
[fluid.alemesh.bdf]
order=2

[solid]
filename=$top_srcdir/applications/models/fsi/wavepressure2d/wavepressure2d_solid.json
rho=1.1  
coeffpoisson=0.5
youngmodulus=0.75e6
model=Generalised-String 
solver=LinearSystem
pc-type=lu
pc-factor-mat-solver-package-type=mumps #umfpack
ksp-maxit=10
#ksp-converged-reason=true
#verbose=true

[ts]
#restart=true
#time-initial=0.0013
time-step=0.0001
time-final=1.0
restart.at-last-save=true

[exporter]
directory=applications/models/fsi/wavepressure2d/P2P1G1-P1G1


[fluid]
# verbose=1
# verbose_solvertimer=1
[solid]
# verbose=1
# verbose_solvertimer=1
[fsi]
# verbose=1
# verbose_solvertimer=1
